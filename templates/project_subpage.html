{% extends "base.html" %}

{% block content %}
<section class="wine-subpage">
  <div class="container">
    <a href="{{ url_for('project_detail', project_id=project.id) }}" class="back-link">
      <i class="fas fa-arrow-left"></i> Volver al proyecto
    </a>

    <div class="subpage-header">
      <h1>
        <i class="fas fa-{{ 'cogs' if subpage == 'preprocesamiento' else 'chart-line' if subpage == 'analisis' else 'robot' }}"></i>
        {{ 'Preprocesamiento' if subpage == 'preprocesamiento' else 'An치lisis' if subpage == 'analisis' else 'Machine Learning' }}
      </h1>
    </div>

    <div class="row">
      <div class="col-lg-8">
        <article class="wine-content">
          {{ project.content[subpage]|safe }}
          
          <!-- Insights como tarjetas -->
          <div class="insights-grid">
            {% for insight in project.insights[subpage] %}
            <div class="insight-card">
              <i class="fas fa-lightbulb"></i>
              <p>{{ insight }}</p>
            </div>
            {% endfor %}
          </div>
        </article>
      </div>
      
      <div class="col-lg-4">
        <aside class="wine-visualization">
          {% if subpage == 'preprocesamiento' %}
          <img src="{{ url_for('static', filename='img/wine_cleaning.jpg') }}" 
               alt="Procesamiento de datos de vinos" class="img-fluid">
          {% elif subpage == 'analisis' %}
          <img src="{{ url_for('static', filename='img/wine_analysis.jpg') }}" 
               alt="An치lisis de vinos" class="img-fluid">
          {% else %}
          <img src="{{ url_for('static', filename='img/wine_ml.jpg') }}" 
               alt="Modelos de ML para vinos" class="img-fluid">
          {% endif %}
        </aside>
        
        <!-- Bot칩n din치mico -->
        <div class="action-button-container">
          {% if subpage == 'analisis' %}
          <a href="{{ project.resources.dashboard }}" class="btn btn-download" download>
            <i class="fas fa-file-download"></i> Descargar Dashboard (.pbix)
          </a>
          {% elif subpage == 'ml' %}
          <a href="{{ project.resources.demo }}" class="btn btn-demo" target="_blank">
            <i class="fas fa-external-link-alt"></i> Ver Demo Interactiva
          </a>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}