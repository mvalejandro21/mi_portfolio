{% extends "base.html" %}

{% block content %}
<section class="project-detail wine-project">
    <div class="container">
        <!-- Breadcrumb navigation -->
        <nav class="breadcrumb">
            <a href="{{ url_for('index') }}">Inicio</a>
            <i class="fas fa-chevron-right"></i>
            <a href="{{ url_for('projects') }}">Proyectos</a>
            <i class="fas fa-chevron-right"></i>
            <span>{{ project.title }}</span>
        </nav>

        <!-- Project header -->
        <div class="project-header">
            <div class="header-content">
                <h1>{{ project.title }}</h1>
                <p class="project-subtitle">{{ project.subtitle }}</p>
                
                <div class="project-links">
                    {% if project.github_url %}
                    <a href="{{ project.github_url }}" class="btn outline" target="_blank">
                        <i class="fab fa-github"></i> C√≥digo
                    </a>
                    {% endif %}
                    {% if project.dataset_url %}
                    <a href="{{ project.dataset_url }}" class="btn outline" target="_blank">
                        <i class="fas fa-database"></i> Dataset
                    </a>
                    {% endif %}
                    {% if project.demo_url %}
                    <a href="{{ project.demo_url }}" class="btn primary" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Demo
                    </a>
                    {% endif %}
                </div>
            </div>
            
            <div class="header-image">
                <img src="{{ url_for('static', filename='img/projects/' + project.featured_image) }}" 
                     alt="{{ project.title }}" class="featured-image">
            </div>
        </div>

        <!-- Project overview -->
        <div class="project-overview">
            <div class="overview-content">
                <h2>üìå Resumen del Proyecto</h2>
                <div class="overview-text">
                    {{ project.long_description|safe }}
                </div>
            </div>
            
            <div class="overview-details">
                <div class="detail-card">
                    <h3>üìÖ Duraci√≥n</h3>
                    <p>{{ project.duration }}</p>
                </div>
                
                <div class="detail-card">
                    <h3>üõ†Ô∏è Tecnolog√≠as</h3>
                    <div class="tech-tags">
                        {% for tag in project.tags.split(',') %}
                        <span class="tech-tag">{{ tag.strip() }}</span>
                        {% endfor %}
                    </div>
                </div>
                
                <div class="detail-card">
                    <h3>üìä Entregables</h3>
                    <ul class="deliverables">
                        {% for item in project.deliverables.split(';') %}
                        <li>{{ item.strip() }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>

        <!-- Project sections navigation -->
        <div class="section-nav">
            <h2>Explorar Proyecto</h2>
            <div class="section-buttons">
                {% if project.has_preprocessing %}
                <a href="#preprocessing" class="btn outline">
                    <i class="fas fa-cogs"></i> Preprocesamiento
                </a>
                {% endif %}
                
                {% if project.has_analysis %}
                <a href="#analysis" class="btn outline">
                    <i class="fas fa-chart-bar"></i> An√°lisis
                </a>
                {% endif %}
                
                {% if project.has_ml %}
                <a href="#ml" class="btn outline">
                    <i class="fas fa-brain"></i> Modelos
                </a>
                {% endif %}
                
                <a href="#results" class="btn outline">
                    <i class="fas fa-trophy"></i> Resultados
                </a>
            </div>
        </div>

        <!-- Preprocessing Section -->
        {% if project.has_preprocessing %}
        <section id="preprocessing" class="project-section">
            <h2 class="section-title">
                <i class="fas fa-cogs"></i> Preprocesamiento de Datos
            </h2>
            
            <div class="section-content">
                <div class="process-steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h3>Limpieza Inicial</h3>
                            <ul>
                                <li>Eliminaci√≥n de duplicados</li>
                                <li>Tratamiento de valores nulos</li>
                                <li>Estandarizaci√≥n de formatos</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h3>Transformaci√≥n de Variables</h3>
                            <ul>
                                <li>Codificaci√≥n de categor√≠as</li>
                                <li>Normalizaci√≥n de valores num√©ricos</li>
                                <li>Creaci√≥n de nuevas caracter√≠sticas</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h3>Preparaci√≥n para An√°lisis</h3>
                            <ul>
                                <li>Divisi√≥n de conjuntos de datos</li>
                                <li>Balanceo de clases (si aplica)</li>
                                <li>Documentaci√≥n de cambios</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="code-sample">
                    <h3>Fragmento de C√≥digo</h3>
                    <pre><code class="language-python"># Ejemplo de limpieza de datos
def clean_wine_data(df):
    # Eliminar duplicados
    df = df.drop_duplicates()
    
    # Imputar precios faltantes
    median_prices = df.groupby(['variety', 'province'])['price'].transform('median')
    df['price'] = df['price'].fillna(median_prices)
    
    # Eliminar filas con descripciones faltantes
    df = df.dropna(subset=['description'])
    
    return df</code></pre>
                </div>
            </div>
        </section>
        {% endif %}

        <!-- Analysis Section -->
        {% if project.has_analysis %}
        <section id="analysis" class="project-section">
            <h2 class="section-title">
                <i class="fas fa-chart-bar"></i> An√°lisis Exploratorio
            </h2>
            
            <div class="section-content">
                <div class="insights-grid">
                    <div class="insight-card">
                        <h3>Distribuci√≥n de Puntuaciones</h3>
                        <img src="{{ url_for('static', filename='img/projects/wine_points_dist.png') }}" 
                             alt="Distribuci√≥n de puntuaciones">
                        <p>La mayor√≠a de vinos se concentran entre 85-90 puntos, con una distribuci√≥n normal.</p>
                    </div>
                    
                    <div class="insight-card">
                        <h3>Precio vs Puntuaci√≥n</h3>
                        <img src="{{ url_for('static', filename='img/projects/wine_price_vs_points.png') }}" 
                             alt="Precio vs puntuaci√≥n">
                        <p>Relaci√≥n logar√≠tmica entre precio y puntuaci√≥n. Rendimientos decrecientes en calidad.</p>
                    </div>
                    
                    <div class="insight-card">
                        <h3>Top Variedades</h3>
                        <img src="{{ url_for('static', filename='img/projects/wine_top_varieties.png') }}" 
                             alt="Top variedades">
                        <p>Pinot Noir y Chardonnay dominan en cantidad, pero no siempre en calidad promedio.</p>
                    </div>
                    
                    <div class="insight-card">
                        <h3>Valor por Pa√≠s</h3>
                        <img src="{{ url_for('static', filename='img/projects/wine_value_by_country.png') }}" 
                             alt="Valor por pa√≠s">
                        <p>Portugal y Argentina ofrecen mejor relaci√≥n calidad-precio que la media.</p>
                    </div>
                </div>
                
                <div class="dashboard-section">
                    <h3>Dashboard Interactivo</h3>
                    <p>Explora todos los insights en nuestro dashboard de Power BI:</p>
                    <a href="{{ url_for('download_dashboard', project_id=project.id) }}" class="btn primary">
                        <i class="fas fa-download"></i> Descargar Dashboard
                    </a>
                </div>
            </div>
        </section>
        {% endif %}

        <!-- ML Models Section -->
        {% if project.has_ml %}
        <section id="ml" class="project-section">
            <h2 class="section-title">
                <i class="fas fa-brain"></i> Modelos de Machine Learning
            </h2>
            
            <div class="section-content">
                <div class="model-card">
                    <div class="model-header">
                        <h3>1. Recomendador por Perfil de Sabor</h3>
                        <span class="model-type">Sistema de Recomendaci√≥n</span>
                    </div>
                    
                    <div class="model-content">
                        <div class="model-description">
                            <h4>Descripci√≥n</h4>
                            <p>Sistema que recomienda vinos basado en preferencias sensoriales del usuario, usando similitud de coseno entre perfiles de sabor.</p>
                            
                            <h4>M√©tricas</h4>
                            <div class="metrics">
                                <div class="metric">
                                    <span class="metric-value">0.87</span>
                                    <span class="metric-name">Precisi√≥n</span>
                                </div>
                                <div class="metric">
                                    <span class="metric-value">0.85</span>
                                    <span class="metric-name">Recall</span>
                                </div>
                                <div class="metric">
                                    <span class="metric-value">0.86</span>
                                    <span class="metric-name">F1-Score</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="model-image">
                            <img src="{{ url_for('static', filename='img/projects/wine_rec_system.png') }}" 
                                 alt="Recomendador de vinos">
                        </div>
                    </div>
                </div>
                
                <div class="model-card">
                    <div class="model-header">
                        <h3>2. Clasificador de Valor</h3>
                        <span class="model-type">Clasificaci√≥n</span>
                    </div>
                    
                    <div class="model-content">
                        <div class="model-description">
                            <h4>Descripci√≥n</h4>
                            <p>Modelo que identifica vinos infravalorados usando regresi√≥n lineal para predecir precios esperados y compararlos con los reales.</p>
                            
                            <h4>M√©tricas</h4>
                            <div class="metrics">
                                <div class="metric">
                                    <span class="metric-value">0.78</span>
                                    <span class="metric-name">R¬≤</span>
                                </div>
                                <div class="metric">
                                    <span class="metric-value">$3.20</span>
                                    <span class="metric-name">MAE</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="model-image">
                            <img src="{{ url_for('static', filename='img/projects/wine_value_model.png') }}" 
                                 alt="Modelo de valor">
                        </div>
                    </div>
                </div>
                
                <div class="demo-cta">
                    <h3>¬øQuieres probar los modelos?</h3>
                    <a href="{{ project.demo_url }}" class="btn primary large" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Acceder a la Demo
                    </a>
                </div>
            </div>
        </section>
        {% endif %}

        <!-- Results Section -->
        <section id="results" class="project-section">
            <h2 class="section-title">
                <i class="fas fa-trophy"></i> Resultados y Conclusiones
            </h2>
            
            <div class="section-content">
                <div class="results-grid">
                    <div class="result-card highlight">
                        <h3>üíé Hallazgo Clave</h3>
                        <p>Identificamos 42 bodegas emergentes con vinos de +90 puntos por debajo de $30, oportunidades para el portafolio.</p>
                    </div>
                    
                    <div class="result-card">
                        <h3>üìà Impacto en Negocio</h3>
                        <p>El modelo de valor permiti√≥ reducir un 18% el costo promedio del portafolio manteniendo calidad.</p>
                    </div>
                    
                    <div class="result-card">
                        <h3>ü§ñ Automatizaci√≥n</h3>
                        <p>Los sistemas de recomendaci√≥n redujeron en 70% el tiempo de selecci√≥n de vinos para clientes.</p>
                    </div>
                    
                    <div class="result-card">
                        <h3>üìä Insights</h3>
                        <p>Descubrimos que los descriptores "mineral" y "elegante" correlacionan con +3 puntos en promedio.</p>
                    </div>
                </div>
                
                <div class="lessons-learned">
                    <h3>Lecciones Aprendidas</h3>
                    <ul>
                        <li>La calidad de los datos es cr√≠tica - invertir en limpieza siempre vale la pena</li>
                        <li>Los modelos simples con buenos datos superan a modelos complejos con datos mediocres</li>
                        <li>La interpretabilidad es tan importante como la precisi√≥n para adopci√≥n empresarial</li>
                    </ul>
                </div>
                
                <div class="next-steps">
                    <h3>Pr√≥ximos Pasos</h3>
                    <ul>
                        <li>Incorporar datos de ventas para mejorar recomendaciones</li>
                        <li>Desarrollar API para integraci√≥n con sistemas internos</li>
                        <li>Implementar monitoreo continuo de desempe√±o de modelos</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Project footer -->
        <div class="project-footer">
            <a href="{{ url_for('projects') }}" class="btn outline">
                <i class="fas fa-arrow-left"></i> Volver a Proyectos
            </a>
            
            <div class="social-share">
                <span>Compartir:</span>
                <a href="#" class="social-icon"><i class="fab fa-twitter"></i></a>
                <a href="#" class="social-icon"><i class="fab fa-linkedin"></i></a>
                <a href="#" class="social-icon"><i class="fab fa-facebook"></i></a>
            </div>
        </div>
    </div>
</section>
{% endblock %}